(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{206:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(78),o=a.n(l),c=(a(86),a(9)),p=a(10),i=a(12),s=a(11),u=a(13),d=(a(87),a(31)),_=a(5),m=a(80),f=a(2),O=a(32),b="".concat("http://localhost/bttc/public/","admin/"),E="".concat("http://localhost/bttc/public/api/","admin/"),h=("".concat(b,"elem/"),"".concat(b,"gallery/"),"".concat(b,"util/"),"".concat(E,"users/"),"".concat(b,"templates/"),"".concat(E,"menu/"),"".concat(b,"page/"),/(\.jpg|\.jpeg|\.png|\.gif)$/i),P=/(\.pdf|\.xls|\.doc)$/i,g=Object.freeze({Uploadable:0,Cancelled:1,"Too Big":2,"Wrong Filetype":3}),v=["Ready","Cancelled","Too Big","Wrong Filetype"],y="OPEN_POPUP",j="CLOSE_POPUP",U="FREEHAND_POST_TYPE",D="TEXT_BOX_POST_TYPE",T="BIG_IMAGE_TYPE",k="MASTER_POPUP",S="FREEHAND_POPUP",I="TEXTBOX_POPUP",N="IMAGE_MASTER_POPUP",A="BIG_IMAGE_POPUP",R="IMAGE_SELECTOR_POPUP",F="IMAGE_DELETE_POPUP",w="LINK_SELECTOR_POPUP",L="SET_IMAGE_LIST_INDEX",C="EDITING_POPUP",x="ADD_POPUP",G="DELETE_POPUP",M="DELETE_EDITOR_POPUP",B="POPUP_PRESET_FOR_TESTING";var z="ADD_UPLOADABLE",X="REMOVE_UPLOADABLE",Y="SET_UPLOAD_STATE",H="INIT_UPLOAD_PAGE",J="SELECT_DIRECTORY",W="READY",V="UPLOAD COMPLETE",$="FILE_PROGRESS",K=function(e,t,a,n,r){return new Promise(function(l,o){return function e(t,a,n,r,o){(function(e,t,a,n,r){return new Promise(function(l){var o=e[t];if(o.enabled!==g.Uploadable)return l(++t);var c=new FormData;c.append("items[]",JSON.stringify({fname:o.fname,file_data:o.file_data})),c.append("dir",a),c.append("filetype",n);var p=0,i=window.setInterval(function(){if(p<=10){if(10===p)return r({type:$,complete:100,fname:o.fname}),t++,clearInterval(i),l(t);r({type:$,complete:10*++p,fname:o.fname})}},50)})})(t,a,n,r,o).then(function(c){(a=c)<t.length?e(t,a,n,r,o):l("all done")})}(e,t,a,n,r)})},q=function(e){return{type:Y,uploadState:e}};var Q={popup_stack:[],image_root:"",image_list:[],image_list_index:-1,max_images:12};function Z(e,t){var a=e.slice();return!a.length||a[a.length-1]!==k&&a[a.length-1]!==N||a.pop(),[].concat(Object(O.a)(a),[t])}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:switch(t.popup_action){case C:switch(t.popup){case k:case N:return Object(f.a)({},e,{popup_stack:Z(e.popup_stack,t.popup)});case U:return Object(f.a)({},e,{popup_stack:Z(e.popup_stack,S)});case D:return Object(f.a)({},e,{popup_stack:Z(e.popup_stack,I)});case T:return Object(f.a)({},e,{popup_stack:Z(e.popup_stack,A)});case w:return Object(f.a)({},e,{popup_stack:Z(e.popup_stack,w)});case R:return Object(f.a)({},e,{image_list:t.image_list,image_root:t.image_root,image_list_index:0,popup_stack:Z(e.popup_stack,R)});case G:case M:case x:case F:return Object(f.a)({},e,{popup_stack:Z(e.popup_stack,t.popup)});default:return e}default:return e}case L:return Object(f.a)({},e,{image_list_index:t.index});case j:return Object(f.a)({},e,{popup_stack:e.popup_stack.slice(0,e.popup_stack.length-1)});case B:return t.preset;default:return e}}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{upload_state:W,upload_ar:[],directories:[],selected_directory:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:var a=Object(f.a)({},t.payload);if(delete a.size,e.upload_ar.findIndex(function(e){return e.fname===a.fname})>=0)return e;var n=g.Uploadable;if(t.payload.size>e.max_size)n=g["Too Big"];else null===("image"===t.payload.filetype?h:P).exec(t.payload.fname)&&(n=g["Wrong Filetype"]);return e.upload_state===V?Object(f.a)({},e,{upload_ar:[Object(f.a)({},a,{enabled:n,complete:W})],upload_state:W}):Object(f.a)({},e,{upload_ar:[].concat(Object(O.a)(e.upload_ar),[Object(f.a)({},a,{enabled:n,complete:W})])});case X:return Object(f.a)({},e,{upload_ar:e.upload_ar.slice(0,t.index).concat(e.upload_ar.slice(t.index+1))});case Y:return Object(f.a)({},e,{upload_state:t.uploadState});case $:var r=e.upload_ar.findIndex(function(e){return e.fname===t.fname});return Object(f.a)({},e,{upload_ar:e.upload_ar.slice(0,r).concat(Object(f.a)({},e.upload_ar[r],{complete:t.complete})).concat(e.upload_ar.slice(r+1))});case H:return Object(f.a)({},e,{directories:t.directories,selected_directory:t.directories[0],max_size:t.max_size,upload_ar:[]});case J:return Object(f.a)({},e,{selected_directory:t.selected});default:return e}}var ae=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||_.compose,ne=Object(_.createStore)(Object(_.combineReducers)({popup:ee,file_upload:te}),{},ae(Object(_.applyMiddleware)(m.a))),re=a(3),le=a(29),oe=a(30),ce=a.n(oe),pe=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.isOver?"drag_drop_over":"drag_drop_normal";return this.props.connectDropTarget(r.a.createElement("div",{className:"target ".concat(e)},"OR DRAG FILES HERE"))}}]),t}(n.Component);var ie=Object(le.DropTarget)(oe.NativeTypes.FILE,{drop:function(e,t,a){var n=t.getItem().files;e.onDrop(n)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),isOverCurrent:t.isOver({shallow:!0}),canDrop:t.canDrop()}})(pe),se=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(s.a)(t).call(this))).selectFile=e.selectFile.bind(Object(re.a)(Object(re.a)(e))),e.doUpload=e.doUpload.bind(Object(re.a)(Object(re.a)(e))),e.fileSelector=r.a.createRef(),e.selectFiles=e.selectFiles.bind(Object(re.a)(Object(re.a)(e))),e.onDrop=e.onDrop.bind(Object(re.a)(Object(re.a)(e))),e.setSelected=e.setSelected.bind(Object(re.a)(Object(re.a)(e))),e}return Object(u.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.initUploadPage(this.props.filetype)}},{key:"doUpload",value:function(){0!==this.props.upload.upload_ar.length&&this.props.doUpload(this.props.upload.upload_ar,this.props.upload.selected_directory,this.props.filetype)}},{key:"selectFile",value:function(e){var t=e.target.files||e.dataTransfer.files;if(t.length){this.files=t;for(var a=0;a<t.length;a++)this.createUploadableFile(t[a])}}},{key:"createUploadableFile",value:function(e){var t=this,a=new FileReader;a.onload=function(a){t.props.addUploadable({fname:e.name,file_data:a.target.result,size:e.size,filetype:t.props.filetype})},a.readAsDataURL(e)}},{key:"selectFiles",value:function(){this.fileSelector.current.click()}},{key:"onDrop",value:function(e){var t=this;Array.isArray(e)?e.map(function(e){return t.createUploadableFile(e)}):this.createUploadableFile(e)}},{key:"setSelected",value:function(e){this.props.selectDirectory(e.target.value)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"small-2 columns"},r.a.createElement("div",{className:"upload-status target"},this.props.upload.upload_state),r.a.createElement("div",null,"Upload To"),"image"===this.props.filetype?r.a.createElement("select",{value:this.props.upload.selected_directory,onChange:this.setSelected},this.props.upload.directories.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})):null,r.a.createElement("button",{className:"button",onClick:this.doUpload,disabled:this.props.upload.upload_state===V},"Upload"),r.a.createElement("button",{className:"button",onClick:this.selectFiles},"select"),r.a.createElement(ie,{onDrop:this.onDrop}),r.a.createElement("div",{style:{display:"none"}},r.a.createElement("input",{ref:this.fileSelector,type:"file",id:"single",onChange:this.selectFile,multiple:!0})),r.a.createElement("div",{className:"drag_drop_panel"})),r.a.createElement("div",{className:"small-10 columns"},r.a.createElement("div",{className:"row gallery-container small-up-2 medium-up-4 large-up-4"},this.props.upload.upload_ar.map(function(t,a){var n=t.complete<100?t.complete+"%":"FINISHED";return r.a.createElement("div",{key:a+t.fname,className:"column column-block gallery"},r.a.createElement("div",{className:" uploadable-thumb-wrap"},"image"===e.props.filetype&t.enabled===g.Uploadable?r.a.createElement("img",{className:"uploadable-thumb",src:t.file_data,alt:"uplodable"+t.file_data}):r.a.createElement("div",{className:"bad_upload_name"},t.fname),r.a.createElement("p",null,t.complete!==W?n:v[t.enabled]),r.a.createElement("p",null,r.a.createElement("button",{id:"remove_"+a,className:"button",onClick:e.props.removeUploadable.bind(e,a),disabled:e.props.upload.upload_state!==W},"Delete"))))})))))}}]),t}(r.a.Component),ue=Object(d.b)(function(e){return{upload:e.file_upload}},function(e){return{doUpload:function(t,a,n){return e(function(e,t,a){return function(n){n(q("UPLOAD IN PROGRESS")),K(e,0,t,a,n).then(function(){return n(q(V))})}}(t,a,n))},addUploadable:function(t){return e({type:z,payload:t})},removeUploadable:function(t){return e(function(e){return{type:X,index:e}}(t))},initUploadPage:function(t){return e({type:H,directories:["slideshow","recipes","ingredients"]})},selectDirectory:function(t){return e({type:J,selected:t})}}})(Object(le.DragDropContext)(ce.a)(se)),de=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,{store:ne},r.a.createElement(ue,{filetype:"image"}))}}]),t}(n.Component);o.a.render(r.a.createElement(de,null),document.getElementById("root"))},81:function(e,t,a){e.exports=a(206)},86:function(e,t,a){},87:function(e,t,a){}},[[81,1,2]]]);
//# sourceMappingURL=main.9e0c6fda.chunk.js.map